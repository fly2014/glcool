<!DOCTYPE html>
<html lang="zh-CN" class="no-js"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script><title>NET – GlCool</title><link rel="dns-prefetch" href="//s.w.org"><link rel="stylesheet" id="wp-block-library-css" href="https://www.glcool.com/wp-includes/css/dist/block-library/style.min.css" media="all"><link rel="stylesheet" id="wp-block-library-theme-css" href="https://www.glcool.com/wp-includes/css/dist/block-library/theme.min.css" media="all"><link rel="stylesheet" id="genericons-css" href="https://www.glcool.com/wp-content/themes/twentyfifteen/genericons/genericons.css" media="all"><link rel="stylesheet" id="twentyfifteen-style-css" href="https://www.glcool.com/wp-content/themes/twentyfifteen/style.css" media="all"><link rel="stylesheet" id="twentyfifteen-block-style-css" href="https://www.glcool.com/wp-content/themes/twentyfifteen/css/blocks.css" media="all"><script src="https://www.glcool.com/wp-includes/js/jquery/jquery.js"></script><script src="https://www.glcool.com/wp-includes/js/jquery/jquery-migrate.min.js"></script></head><body class="archive category category-net category-3 wp-embed-responsive">
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">跳至内容</a>

	<div id="sidebar" class="sidebar">
		<header id="masthead" class="site-header" role="banner"><div class="site-branding">
										<p class="site-title"><a href="https://www.glcool.com/" rel="home">GlCool</a></p>
												<p class="site-description">The Global Coolest</p>
										<button class="secondary-toggle">菜单和挂件</button>
			</div>
		</header><div id="secondary" class="secondary">

		
		
					<div id="widget-area" class="widget-area" role="complementary">
						<aside id="recent-posts-2" class="widget widget_recent_entries"><h2 class="widget-title">近期文章</h2>		<ul><li>
					<a href="https://www.glcool.com/archives/362">DbContext与IOC与多线程</a>
									</li>
											<li>
					<a href="https://www.glcool.com/archives/360">WPF 与 IOC与Nlog</a>
									</li>
											<li>
					<a href="https://www.glcool.com/archives/346">LINUX常用命令</a>
									</li>
											<li>
					<a href="https://www.glcool.com/archives/343">GIT常用命令</a>
									</li>
											<li>
					<a href="https://www.glcool.com/archives/313">windows10-tensorflow2安装</a>
									</li>
					</ul></aside><aside id="pages-2" class="widget widget_pages"><h2 class="widget-title">页面</h2>		<ul><li class="page_item page-item-315"><a href="https://www.glcool.com/about">关于</a></li>
		</ul></aside><aside id="categories-3" class="widget widget_categories"><h2 class="widget-title">分类目录</h2>		<ul><li class="cat-item cat-item-2"><a href="https://www.glcool.com/archives/category/iot">IOT</a>
</li>
	<li class="cat-item cat-item-52"><a href="https://www.glcool.com/archives/category/linux">Linux</a>
</li>
	<li class="cat-item cat-item-3 current-cat"><a aria-current="page" href="https://www.glcool.com/archives/category/net">NET</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://www.glcool.com/archives/category/php">PHP</a>
</li>
	<li class="cat-item cat-item-5"><a href="https://www.glcool.com/archives/category/tensorflow">TensorFlow</a>
</li>
	<li class="cat-item cat-item-6"><a href="https://www.glcool.com/archives/category/windows">Windows</a>
</li>
	<li class="cat-item cat-item-7"><a href="https://www.glcool.com/archives/category/blockchain">区块链</a>
</li>
	<li class="cat-item cat-item-8"><a href="https://www.glcool.com/archives/category/%e6%95%b0%e6%8d%ae%e5%ba%93">数据库</a>
</li>
	<li class="cat-item cat-item-1"><a href="https://www.glcool.com/archives/category/uncategorized">未分类</a>
</li>
	<li class="cat-item cat-item-9"><a href="https://www.glcool.com/archives/category/%e6%b6%88%e6%81%af%e9%98%9f%e5%88%97">消息队列</a>
</li>
		</ul></aside></div>
		
	</div>

	</div>

	<div id="content" class="site-content">

	<section id="primary" class="content-area"><main id="main" class="site-main" role="main"><header class="page-header"><h1 class="page-title">分类：NET</h1>			</header><article id="post-362" class="post-362 post type-post status-publish format-standard hentry category-net category-8 tag-dbcontext tag-ioc tag-56"><header class="entry-header"><h2 class="entry-title"><a href="https://www.glcool.com/archives/362" rel="bookmark">DbContext与IOC与多线程</a></h2>	</header><div class="entry-content">
		<p>1、先看报错日志：</p>
<pre> An exception occurred while iterating over the results of a query for context type 'Mes.Data.MesContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext() A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.|Microsoft.EntityFrameworkCore.Query|contextType=Mes.Data.MesContext, newline=
, error=System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see <span style="color: #ff0000;">https://go.microsoft.com/fwlink/?linkid=2097913</span>.</pre>
<p>微软官方明确不支持多线程，真是败笔。不支持单例复用。每次都是需要实例化（不用担心资源消耗问题）。但是前面的IOC 仓储代码需要丢弃，这好蛋疼<br>
2、解决方案看代码：</p>
<pre>public class ServiceLocator
    {
        public static IServiceProvider Services { get; private set; }
        public static void SetServices(IServiceProvider services)
        {
            Services = services;
        }
        public static T GetService()
        {
            return Services.GetService();
        }
    }
</pre>
<pre>
services.AddDbContext<MesContext>(options =>
{
options.UseSqlServer(hostContext.Configuration.GetConnectionString("Mes")).UseLoggerFactory(NLoggerFactory).UseQueryTrackingBehavior(QueryTrackingBehavior.NoTracking);
},<span style="color: #ff0000;">ServiceLifetime.Transient</span>);                    
ServiceLocator.SetServices(services.BuildServiceProvider());
//注意其他仓储，服务层全部注册为ServiceLifetime.Transient模式
//调用代码（多线程里面每次需要调用，不能复用，没有测试性能问题）：
//_isysOpcCodeService = ServiceLocator.GetService<IsysOpcCodeService>();
//_isysOpcCodeService.GetAll().Take(3).ToList();
</pre>
	</div>

	
	<footer class="entry-footer"><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="https://www.glcool.com/archives/362" rel="bookmark"><time class="entry-date published updated" datetime="2020-08-31T11:42:23+08:00">2020年8月31日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="https://www.glcool.com/archives/category/net" rel="category tag">NET</a>、<a href="https://www.glcool.com/archives/category/%e6%95%b0%e6%8d%ae%e5%ba%93" rel="category tag">数据库</a></span><span class="tags-links"><span class="screen-reader-text">标签 </span><a href="https://www.glcool.com/archives/tag/dbcontext" rel="tag">DbContext</a>、<a href="https://www.glcool.com/archives/tag/ioc" rel="tag">IOC</a>、<a href="https://www.glcool.com/archives/tag/%e5%a4%9a%e7%ba%bf%e7%a8%8b" rel="tag">多线程</a></span><span class="comments-link"><a href="https://www.glcool.com/archives/362#respond"><span class="screen-reader-text">于DbContext与IOC与多线程</span>留下评论</a></span>			</footer></article><article id="post-360" class="post-360 post type-post status-publish format-standard hentry category-net category-windows tag-ioc tag-nlog tag-wpf"><header class="entry-header"><h2 class="entry-title"><a href="https://www.glcool.com/archives/360" rel="bookmark">WPF 与 IOC与Nlog</a></h2>	</header><div class="entry-content">
		<p>1、新建一个WPF core项目</p>
<p>2、删除App.xaml之中StartupUri=”MainWindow.xaml”代码</p>
<p>3、修改app代码</p>
<pre>public partial class App : Application
{
public IConfiguration Configuration;
private IServiceProvider _serviceProvider;

protected override void OnStartup(StartupEventArgs e)
{
var builder = new ConfigurationBuilder().SetBasePath(Directory.GetCurrentDirectory())
.AddJsonFile("appsettings.json", optional: false, reloadOnChange: true);

Configuration = builder.Build();

var serviceCollection = new ServiceCollection();
ConfigureServices(serviceCollection);

_serviceProvider = serviceCollection.BuildServiceProvider();

var mainWindow = _serviceProvider.GetRequiredService<MainWindow>();
mainWindow.Show();
}
private void ConfigureServices(IServiceCollection services)
{
services.AddLogging(logging =>
{
logging.ClearProviders();
logging.SetMinimumLevel(Microsoft.Extensions.Logging.LogLevel.Trace);
logging.AddNLog(Configuration.GetSection("Logging"));
});
services.AddSingleton(typeof(MainWindow));
services.AddSingleton<IOpcService, OpcService>();
}
}
</pre>
<p>4、修改windows代码</p>
<pre>public partial class MainWindow : Window
{
private readonly ILogger<MainWindow> _logger;
private readonly IOpcService _opcService;
public MainWindow(ILogger<MainWindow> logger, IOpcService opcService )
{
_logger = logger;
_opcService = opcService;
_logger.LogDebug("开始");
InitializeComponent();
}
}
</pre>
<p>5、执行F5</p>
<p>appsettings.json参考微软教程</p>
<p>nlog.config参考<a href="https://github.com/NLog/NLog/wiki/Getting-started-with-.NET-Core-2---Console-application">https://github.com/NLog/NLog/wiki/Getting-started-with-.NET-Core-2—Console-application</a></p>
	</div>

	
	<footer class="entry-footer"><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="https://www.glcool.com/archives/360" rel="bookmark"><time class="entry-date published updated" datetime="2020-08-31T11:29:01+08:00">2020年8月31日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="https://www.glcool.com/archives/category/net" rel="category tag">NET</a>、<a href="https://www.glcool.com/archives/category/windows" rel="category tag">Windows</a></span><span class="tags-links"><span class="screen-reader-text">标签 </span><a href="https://www.glcool.com/archives/tag/ioc" rel="tag">IOC</a>、<a href="https://www.glcool.com/archives/tag/nlog" rel="tag">NLOG</a>、<a href="https://www.glcool.com/archives/tag/wpf" rel="tag">WPF</a></span><span class="comments-link"><a href="https://www.glcool.com/archives/360#respond"><span class="screen-reader-text">于WPF 与 IOC与Nlog</span>留下评论</a></span>			</footer></article><article id="post-308" class="post-308 post type-post status-publish format-standard hentry category-net tag-43"><header class="entry-header"><h2 class="entry-title"><a href="https://www.glcool.com/archives/308" rel="bookmark">C#动态编译表达式</a></h2>	</header><div class="entry-content">
		<p>下面是原始方案<br>
public object ComplierCode(string expression, ILogService logService, out string errorString)<br>
        {<br>
            string code = WrapExpression(expression);<br>
            object retvalue = null;<br>
            errorString = “”;<br>
            CSharpCodeProvider csharpCodeProvider = new CSharpCodeProvider();<br>
            try<br>
            {<br>
                //编译的参数<br>
                CompilerParameters compilerParameters = new CompilerParameters<br>
                {<br>
                    CompilerOptions = “/t:library”,<br>
                    GenerateInMemory = true<br>
                };<br>
                //开始编译<br>
                CompilerResults compilerResults = csharpCodeProvider.CompileAssemblyFromSource(compilerParameters, code);<br>
                if (compilerResults.Errors.Count > 0)<br>
                {<br>
                    StringBuilder sb = new StringBuilder();<br>
                    for (int i = 0; i  0 ? “;” : “”);<br>
                        sb.Append(compilerResults.Errors[i].ErrorText);<br>
                    }<br>
                    errorString = sb.ToString();<br>
                    throw new Exception(“编译出错！” + sb.ToString());<br>
                }</p>
<p>                Assembly assembly = compilerResults.CompiledAssembly;<br>
                Type type = assembly.GetType(“ExpressionCalculate”);<br>
                MethodInfo method = type.GetMethod(“Calculate”);<br>
                retvalue = method.Invoke(null, null);<br>
            }<br>
            catch (Exception ex)<br>
            {<br>
                logService.WriteLog(“编译出错,code=” + code, ex);<br>
            }<br>
            finally<br>
            {<br>
                csharpCodeProvider.Dispose();<br>
            }<br>
            return retvalue;<br>
        }</p>
<p>        private string WrapExpression(string expression)<br>
        {<br>
            string code = @”<br>
                using System;</p>
<p>                class ExpressionCalculate<br>
                {<br>
                    public static object Calculate()<br>
                    {<br>
                        return {0};<br>
                    }<br>
                }<br>
            “;<br>
            return code.Replace(“{0}”, expression);<br>
        }<br>
其他方案：https://github.com/davideicardi/DynamicExpresso</p>
	</div>

	
	<footer class="entry-footer"><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="https://www.glcool.com/archives/308" rel="bookmark"><time class="entry-date published" datetime="2019-11-08T14:00:27+08:00">2019年11月8日</time><time class="updated" datetime="2020-05-28T13:21:53+08:00">2020年5月28日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="https://www.glcool.com/archives/category/net" rel="category tag">NET</a></span><span class="tags-links"><span class="screen-reader-text">标签 </span><a href="https://www.glcool.com/archives/tag/%e5%8a%a8%e6%80%81%e7%bc%96%e8%af%91" rel="tag">动态编译</a></span><span class="comments-link"><a href="https://www.glcool.com/archives/308#respond"><span class="screen-reader-text">于C#动态编译表达式</span>留下评论</a></span>			</footer></article><article id="post-297" class="post-297 post type-post status-publish format-standard hentry category-net tag-centos7 tag-net-core"><header class="entry-header"><h2 class="entry-title"><a href="https://www.glcool.com/archives/297" rel="bookmark">Linux CentOS7安装NET Core</a></h2>	</header><div class="entry-content">
		<p>sudo rpm -Uvh https://packages.microsoft.com/config/rhel/7/packages-microsoft-prod.rpm<br>
sudo yum update<br>
sudo yum install dotnet-sdk-2.2-2.2.108-1</p>
<p>安装守护进程<br>
yum install supervisor<br>
systemctl enable supervisord.service<br>
systemctl start supervisord.service<br>
systemctl status supervisord.service<br>
vi /etc/supervisord.conf(修改9001端口注释，打开防火墙，重启)<br>
systemctl restart supervisord.service<br>
参考：https://my.oschina.net/weidedong/blog/747428</p>
	</div>

	
	<footer class="entry-footer"><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="https://www.glcool.com/archives/297" rel="bookmark"><time class="entry-date published" datetime="2019-08-08T17:11:46+08:00">2019年8月8日</time><time class="updated" datetime="2020-05-28T13:21:53+08:00">2020年5月28日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="https://www.glcool.com/archives/category/net" rel="category tag">NET</a></span><span class="tags-links"><span class="screen-reader-text">标签 </span><a href="https://www.glcool.com/archives/tag/centos7" rel="tag">CentOS7</a>、<a href="https://www.glcool.com/archives/tag/net-core" rel="tag">NET Core</a></span><span class="comments-link"><a href="https://www.glcool.com/archives/297#respond"><span class="screen-reader-text">于Linux CentOS7安装NET Core</span>留下评论</a></span>			</footer></article><article id="post-294" class="post-294 post type-post status-publish format-standard hentry category-net tag-javascript"><header class="entry-header"><h2 class="entry-title"><a href="https://www.glcool.com/archives/294" rel="bookmark">C#动态执行javascript</a></h2>	</header><div class="entry-content">
		<p>Create a file in Notepad with only these contents:</p>
<p>class EvalClass { function Evaluate(expression: String) { return eval(expression); } }<br>
Save the file as C:\MyEval.js</p>
<p>Open a VS2005 Command Prompt (Start, Programs, VS2005, VS2005 Tools)</p>
<p>Type Cd\ to get to C:\</p>
<p>Type</p>
<p>jsc /t:library C:\MyEval.js<br>
A new file is created named MyEval.dll.</p>
<p>Copy MyEval.dll to the project and reference it (also reference Microsoft.Jscript.dll).</p>
<p>Then you should be able to call it like this:</p>
<p>Dim jScriptEvaluator As New EvalClass<br>
Dim objResult As Object<br>
objResult = jScriptEvaluator.Evaluate(“1==1 && 2==2”)<br>
其他方式：https://github.com/davideicardi/DynamicExpresso（支持netcore）</p>
	</div>

	
	<footer class="entry-footer"><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="https://www.glcool.com/archives/294" rel="bookmark"><time class="entry-date published" datetime="2019-08-07T17:32:25+08:00">2019年8月7日</time><time class="updated" datetime="2020-05-28T13:21:53+08:00">2020年5月28日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="https://www.glcool.com/archives/category/net" rel="category tag">NET</a></span><span class="tags-links"><span class="screen-reader-text">标签 </span><a href="https://www.glcool.com/archives/tag/javascript" rel="tag">javascript</a></span><span class="comments-link"><a href="https://www.glcool.com/archives/294#respond"><span class="screen-reader-text">于C#动态执行javascript</span>留下评论</a></span>			</footer></article><article id="post-278" class="post-278 post type-post status-publish format-standard hentry category-net tag-nlog"><header class="entry-header"><h2 class="entry-title"><a href="https://www.glcool.com/archives/278" rel="bookmark">NET之NLOG使用</a></h2>	</header><div class="entry-content">
		<p>安装<br><code>Install-Package NLog.Config</code><br>
配置文件</p>
<pre>  <nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.nlog-project.org/schemas/NLog.xsd NLog.xsd"
      autoReload="true"
      throwExceptions="false"
      internalLogLevel="Trace" internalLogToConsole="false" internalLogFile="nlog-internal.log">
  <targets  async="true">
    <target name="logfile" xsi:type="File" fileName="file.txt" />
    <target name="logconsole" xsi:type="Console" />
  </targets>
  <rules>
    <logger name="*" minlevel="Info" writeTo="logconsole,logfile" />
    <logger name="*" minlevel="Debug" writeTo="logconsole" />
    <logger name="*" minlevel="Error" writeTo="logconsole,logfile" />
  </rules>
</nlog>  
</pre>
<p>使用<br><code>public static readonly NLog.Logger Logger = NLog.LogManager.GetCurrentClassLogger();<br>
Logger.Error("Error" + (e.Source as AccordionStyleControl).Tag.ToString());</code></p>
	</div>

	
	<footer class="entry-footer"><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="https://www.glcool.com/archives/278" rel="bookmark"><time class="entry-date published" datetime="2019-07-09T11:19:47+08:00">2019年7月9日</time><time class="updated" datetime="2020-05-28T13:21:54+08:00">2020年5月28日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="https://www.glcool.com/archives/category/net" rel="category tag">NET</a></span><span class="tags-links"><span class="screen-reader-text">标签 </span><a href="https://www.glcool.com/archives/tag/nlog" rel="tag">NLOG</a></span><span class="comments-link"><a href="https://www.glcool.com/archives/278#respond"><span class="screen-reader-text">于NET之NLOG使用</span>留下评论</a></span>			</footer></article><article id="post-258" class="post-258 post type-post status-publish format-standard hentry category-net tag-c tag-winform tag-50"><header class="entry-header"><h2 class="entry-title"><a href="https://www.glcool.com/archives/258" rel="bookmark">C# winform 自定义透明控件，可以重叠</a></h2>	</header><div class="entry-content">
		<p>直接上代码：<br><code><br>
using System;<br>
using System.Collections.Generic;<br>
using System.ComponentModel;<br>
using System.Drawing;<br>
using System.Data;<br>
using System.Linq;<br>
using System.Text;<br>
using System.Threading.Tasks;<br>
using System.Windows.Forms;<br>
using System.Drawing.Drawing2D;<br>
using System.Runtime.InteropServices;<br>
using System.Drawing.Imaging;</code></p>
<p>namespace WFControl<br>
{<br>
public partial class ArrowLine : UserControl<br>
{<br><span style="color: #ff0000;">protected override CreateParams CreateParams</span><br><span style="color: #ff0000;">{</span><br><span style="color: #ff0000;">get</span><br><span style="color: #ff0000;">{</span><br><span style="color: #ff0000;">CreateParams cp = base.CreateParams;</span><br><span style="color: #ff0000;">cp.ExStyle |= 0x00000020;</span><br><span style="color: #ff0000;">return cp;</span><br><span style="color: #ff0000;">}</span><br><span style="color: #ff0000;">}</span><br>
public ArrowLine()<br>
{<br>
InitializeComponent();<br><span style="color: #ff0000;">[subscribe]this.SetStyle(ControlStyles.SupportsTransparentBackColor | ControlStyles.UserPaint | ControlStyles.AllPaintingInWmPaint | ControlStyles.Opaque, true);[/subscribe]</span><br>
this.SetStyle(ControlStyles.ResizeRedraw, false);<br>
}<br>
private int mlineHeight = 5;<br>
private byte mdirection = 0;</p>
<p>///</p>
<p>/// 线条宽度.<br>
///</p>
<p>[Description(“宽度”)]</p>
<p>public int LineHeight<br>
{<br>
get<br>
{<br>
return mlineHeight;<br>
}<br>
set<br>
{<br>
mlineHeight = value;<br>
}<br>
}<br>
private int mIsArrow = 0;<br>
///</p>
<p>/// 是否显示箭头.<br>
///</p>
<p>[Description(“箭头”)]<br>
public int IsArrow<br>
{<br>
get { return mIsArrow; }<br>
set<br>
{<br>
mIsArrow = value;<br>
}<br>
}<br>
///</p>
<p>/// 线条方向<br>
///0:从右至左;1:从下至上；2：从左至右;3:从上至下.<br>
///</p>
<p>[Description(“类型”)]</p>
<p>public byte Direction<br>
{<br>
get<br>
{<br>
return mdirection;<br>
}<br>
set<br>
{<br>
mdirection = value;<br>
}<br>
}<br>
[Description(“颜色”)]<br>
public Color color<br>
{<br>
get;<br>
set;<br>
}<br>
protected override void OnPaint(PaintEventArgs e)<br>
{<br>
Color drawColor = Color.FromArgb(0, Color.Purple);<br>
Brush brush = new SolidBrush(drawColor);</p>
<p>Pen pen = new Pen(this.color);<br>
pen.Width = LineHeight;<br>
AdjustableArrowCap aac = null;<br>
AdjustableArrowCap aac1 = null;<br>
if (mIsArrow == 1)<br>
{<br>
aac = new AdjustableArrowCap(4, 2);<br>
pen.CustomStartCap = aac;<br>
}<br>
if (mIsArrow == 2)<br>
{<br>
aac = new AdjustableArrowCap(4, 2);<br>
pen.CustomEndCap = aac;<br>
}<br>
if (mIsArrow == 3)<br>
{<br>
aac = new AdjustableArrowCap(4, 2);<br>
aac1 = new AdjustableArrowCap(4, 2);<br>
pen.CustomStartCap = aac;<br>
pen.CustomEndCap = aac1;<br>
}</p>
<p>int lenWidth = mlineHeight;<br>
int x1 = 0;<br>
int y1 = 0;<br>
int x2 = 0;<br>
int y2 = 0;<br>
if (Direction == 0)<br>
{<br>
// 0:从右至左; 1:从下至上；2：从左至右; 3:从上至下.<br>
x1 = this.Size.Width;<br>
y1 = this.Size.Height / 2;<br>
x2 = 0;<br>
y2 = y1;<br>
}<br>
else if (Direction == 1)<br>
{<br>
x1 = this.Size.Width / 2;<br>
y1 = this.Size.Height;<br>
x2 = x1;<br>
y2 = 0;<br>
}<br>
else if (Direction == 2)<br>
{<br>
//2：从左至右;<br>
x1 = 0;<br>
y1 = this.Size.Height / 2;<br>
x2 = this.Size.Width;<br>
y2 = y1;<br>
}<br>
else if (Direction == 3)<br>
{<br>
//3:从上至下.<br>
x1 = this.Size.Width / 2;<br>
y1 = 0;<br>
x2 = x1;<br>
y2 = this.Size.Height;<br>
}</p>
<p>//e.Graphics.FillRectangle(brush, 0, 0, this.Size.Width, this.Size.Height);<br>
e.Graphics.DrawLine(pen, x1, y1, x2, y2);<br>
pen.Dispose();<br>
if (mIsArrow == 1 || mIsArrow == 2)<br>
{<br>
aac.Dispose();<br>
}<br>
if (mIsArrow == 3)<br>
{<br>
aac.Dispose();<br>
aac1.Dispose();<br>
}<br>
brush.Dispose();<br>
}<br>
}<br>
}</p>
	</div>

	
	<footer class="entry-footer"><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="https://www.glcool.com/archives/258" rel="bookmark"><time class="entry-date published" datetime="2019-06-06T14:08:59+08:00">2019年6月6日</time><time class="updated" datetime="2020-05-28T13:21:54+08:00">2020年5月28日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="https://www.glcool.com/archives/category/net" rel="category tag">NET</a></span><span class="tags-links"><span class="screen-reader-text">标签 </span><a href="https://www.glcool.com/archives/tag/c" rel="tag">C#</a>、<a href="https://www.glcool.com/archives/tag/winform" rel="tag">winform</a>、<a href="https://www.glcool.com/archives/tag/%e9%80%8f%e6%98%8e%e6%8e%a7%e4%bb%b6" rel="tag">透明控件</a></span><span class="comments-link"><a href="https://www.glcool.com/archives/258#respond"><span class="screen-reader-text">于C# winform 自定义透明控件，可以重叠</span>留下评论</a></span>			</footer></article></main></section></div>

	<footer id="colophon" class="site-footer" role="contentinfo"><div class="site-info">
									<a class="imprint">2020-02-02--@github
			</a>
		</div>
	</footer></div>

<script src="https://www.glcool.com/wp-content/themes/twentyfifteen/js/skip-link-focus-fix.js"></script><script>
var screenReaderText = {"expand":"<span class=\"screen-reader-text\">\u5c55\u5f00\u5b50\u83dc\u5355<\/span>","collapse":"<span class=\"screen-reader-text\">\u6298\u53e0\u5b50\u83dc\u5355<\/span>"};
</script><script src="https://www.glcool.com/wp-content/themes/twentyfifteen/js/functions.js"></script></body></html>
